From 9d6756fed2238fcf1fdd1d00424b57bad46ad4fe Mon Sep 17 00:00:00 2001
From: Matt Madison <matt@madison.systems>
Date: Thu, 17 Feb 2022 06:22:36 -0800
Subject: [PATCH] Hack acinclude.m4 python checks for cross-building

Signed-off-by: Matt Madison <matt@madison.systems>
---
 acinclude.m4 | 3 ++-
 1 file changed, 2 insertions(+), 1 deletion(-)

diff --git a/acinclude.m4 b/acinclude.m4
index c0d1a5e..54be8e7 100644
--- a/acinclude.m4
+++ b/acinclude.m4
@@ -87,7 +87,7 @@ if $PYTHON-config --help 1>/dev/null 2>/dev/null; then
     dnl overrid this.
     PYTHON_LIB_LOC=/usr/lib
   else
-    PYTHON_LIB_LOC=$PYTHON_LIB/config
+    PYTHON_LIB_LOC=`readlink -f $PYTHON_LIB/..`
 
     # default to prefix/lib for distros that don't have a link in
     # .../pythonX.Y/config/
@@ -98,6 +98,7 @@ if $PYTHON-config --help 1>/dev/null 2>/dev/null; then
         PYTHON_LIB_LOC=${py_prefix}/lib
       fi
     fi
+    PYTHON_LIBS="-L$PYTHON_LIB_LOC -lpython${PYTHON_VERSION}${PYTHON_ABI_FLAGS}"
   fi
 else
   PYTHON_LIBS="-L${py_prefix}/lib -lpython${PYTHON_VERSION}"
